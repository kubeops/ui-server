apiVersion: meta.k8s.appscode.com/v1alpha1
kind: ResourceOutline
metadata:
  creationTimestamp: null
  labels:
    k8s.io/group: kubedb.com
    k8s.io/kind: Postgres
    k8s.io/resource: postgreses
    k8s.io/version: v1alpha2
  name: kubedb.com-v1alpha2-postgreses-kubedb
spec:
  defaultLayout: false
  header:
    actions:
      create: Never
    displayMode: Field
    kind: Connection
    query:
      byLabel: view
      type: GraphQL
    ref:
      group: core.k8s.appscode.com
      kind: GenericResource
    view:
      name: core.k8s.appscode.com-v1alpha1-genericresources-kubedb
  pages:
  - name: Overview
    sections:
    - blocks:
      - actions:
          create: Never
        displayMode: List
        fieldPath: '{.response.dashboards[0].panels}'
        kind: Connection
        query:
          raw: |
            request:
              embeddedLink: true
              dashboards:
              - title: "KubeDB / Postgres / Summary"
                vars:
                - name: namespace
                  value: {{ .namespace }}
                - name: app
                  value: {{ .name }}
                panels:
                  - { "title": "CPU Usage", "width": 12 }
                  - { "title": "Memory Usage", "width": 12 }
                  - { "title": "Disk Usage", "width": 6 }
                  - { "title": "Disk R/W Info", "width": 6 }
                  - { "title": "IOPS (Reads+Writes)", "width": 6 }
                  - { "title": "ThroughPut (Read+Write)", "width": 6 }
                  - { "title": "Receive Bandwidth", "width": 6 }
                  - { "title": "Transmit Bandwidth", "width": 6 }
          type: REST
        ref:
          group: ui.openviz.dev
          kind: DashboardGroup
        view:
          name: ui.openviz.dev-v1alpha1-dashboardgroups-panels
      - actions:
          create: Never
        displayMode: List
        kind: Connection
        name: Nodes
        query:
          raw: |-
            query Find($src: String!, $targetGroup: String!, $targetKind: String!) {
              find(oid: $src) {
                offshoot(group: "", kind: "Pod") {
                  refs: view(group: $targetGroup, kind: $targetKind) {
                    namespace
                    name
                  }
                }
              }
            }
          type: GraphQL
        ref:
          group: core.k8s.appscode.com
          kind: PodView
        view:
          name: core.k8s.appscode.com-v1alpha1-podviews-kubedb-postgreses
      info:
        actions:
          create: Never
        displayMode: List
        kind: Connection
        query:
          byLabel: connect_via
          type: GraphQL
        ref:
          group: appcatalog.appscode.com
          kind: AppBinding
      insight:
        actions:
          create: Never
        displayMode: Field
        kind: Connection
        query:
          byLabel: view
          type: GraphQL
        ref:
          group: ui.kubedb.com
          kind: PostgresInsight
  - name: Database Insights
    sections:
    - blocks:
      - actions:
          create: Never
        displayMode: List
        fieldPath: .spec.replicationStatus
        kind: Connection
        name: Replication Status
        query:
          byLabel: view
          type: GraphQL
        ref:
          group: ui.kubedb.com
          kind: PostgresInsight
        view:
          name: ui.kubedb.com-v1alpha1-postgresinsights-replicationstatus
      - actions:
          create: Never
        displayMode: List
        fieldPath: .response.dashboards
        kind: Connection
        name: Grafana Dashboards
        query:
          raw: |
            request:
              sourceLocator:
                resource:
                  group: kubedb.com
                  name: postgreses
                  version: v1alpha2
                ref:
                  name: {{ .name }}
                  namespace: {{ .namespace }}
              name: kubedb.com-v1alpha2-postgreses
          type: REST
        ref:
          group: meta.k8s.appscode.com
          kind: RenderDashboard
        view:
          name: ui.k8s.appscode.com-v1alpha1-resourcedashboards-urls
      - actions:
          create: Never
        displayMode: List
        fieldPath: .spec.queries
        kind: Connection
        name: Slow Queries
        query:
          byLabel: view
          type: GraphQL
        ref:
          group: ui.kubedb.com
          kind: PostgresQueries
        view:
          name: ui.kubedb.com-v1alpha1-postgresqueries-queries
      - actions:
          create: Never
        displayMode: List
        fieldPath: .spec.databases
        kind: Connection
        name: Databases
        query:
          byLabel: view
          type: GraphQL
        ref:
          group: ui.kubedb.com
          kind: PostgresSchemaOverview
        view:
          name: ui.kubedb.com-v1alpha1-postgresschemaoverviews-databases
      info:
        actions:
          create: Never
        displayMode: Field
        fieldPath: .spec.settings
        kind: Connection
        query:
          byLabel: view
          type: GraphQL
        ref:
          group: ui.kubedb.com
          kind: PostgresSettings
        view:
          name: ui.kubedb.com-v1alpha1-postgressettings-settings
      insight:
        actions:
          create: Never
        displayMode: Field
        kind: Connection
        query:
          byLabel: view
          type: GraphQL
        ref:
          group: ui.kubedb.com
          kind: PostgresInsight
  - name: Users
    sections:
    - blocks:
      - actions:
          create: Never
        displayMode: List
        kind: Connection
        name: Root User
        query:
          byLabel: auth_secret
          type: GraphQL
        ref:
          group: ""
          kind: Secret
        view:
          name: core-v1-secrets
      - actions:
          create: Never
        displayMode: List
        kind: Connection
        name: AppBindings
        query:
          byLabel: connect_via
          type: GraphQL
        ref:
          group: appcatalog.appscode.com
          kind: AppBinding
        view:
          name: appcatalog.appscode.com-v1alpha1-appbindings-kubedb
      - actions:
          create: Always
        displayMode: List
        kind: Connection
        name: VaultServers
        query:
          raw: |-
            query Find($src: String!, $targetGroup: String!, $targetKind: String!) {
              find(oid: $src) {
                authz(group: "engine.kubevault.com", kind: "SecretEngine") {
                  refs: offshoot(group: $targetGroup, kind: $targetKind) {
                    namespace
                    name
                  }
                }
             }
            }
          type: GraphQL
        ref:
          group: kubevault.com
          kind: VaultServer
        view:
          name: kubevault.com-v1alpha2-vaultservers
      - actions:
          create: Always
        displayMode: List
        kind: Connection
        name: SecretEngines
        query:
          byLabel: authz
          type: GraphQL
        ref:
          group: engine.kubevault.com
          kind: SecretEngine
        view:
          name: engine.kubevault.com-v1alpha1-secretengines
      - actions:
          create: Always
        displayMode: List
        kind: Connection
        name: PostgresRoles
        query:
          byLabel: authz
          type: GraphQL
        ref:
          group: engine.kubevault.com
          kind: PostgresRole
        view:
          name: engine.kubevault.com-v1alpha1-postgresroles
      - actions:
          create: Always
        displayMode: List
        kind: Connection
        name: SecretAccessRequests
        query:
          byLabel: authz
          type: GraphQL
        ref:
          group: engine.kubevault.com
          kind: SecretAccessRequest
        view:
          name: engine.kubevault.com-v1alpha1-secretaccessrequests
  - name: Operations
    sections:
    - blocks:
      - actions:
          create: Never
        displayMode: List
        kind: Connection
        name: Recent Operations
        query:
          byLabel: ops
          type: GraphQL
        ref:
          group: ops.kubedb.com
          kind: PostgresOpsRequest
        view:
          name: ops.kubedb.com-v1alpha1-postgresopsrequests-kubedb
      - actions:
          create: Never
        displayMode: List
        kind: Connection
        name: Recommendations
        query:
          byLabel: recommended_for
          type: GraphQL
        ref:
          group: supervisor.appscode.com
          kind: Recommendation
        view:
          name: supervisor.appscode.com-v1alpha1-recommendations-kubedb
  - name: Backups
    sections:
    - blocks:
      - actions:
          create: Never
        displayMode: List
        kind: Connection
        name: Recent Backups
        query:
          raw: |-
            query Find($src: String!, $targetGroup: String!, $targetKind: String!) {
              find(oid: $src) {
                backup_via(group: "stash.appscode.com", kind: "BackupConfiguration") {
                  refs: offshoot(group: $targetGroup, kind: $targetKind) {
                    namespace
                    name
                  }
                }
              }
            }
          type: GraphQL
        ref:
          group: stash.appscode.com
          kind: BackupSession
        view:
          name: stash.appscode.com-v1beta1-backupsessions-kubedb
      - actions:
          create: Never
        displayMode: List
        kind: Connection
        name: Recent Restores
        query:
          byLabel: restore_into
          type: GraphQL
        ref:
          group: stash.appscode.com
          kind: RestoreSession
        view:
          name: stash.appscode.com-v1beta1-restoresessions-kubedb
      info:
        actions:
          create: Never
        displayMode: Field
        kind: Connection
        query:
          raw: |-
            query Find($src: String!, $targetGroup: String!, $targetKind: String!) {
              find(oid: $src) {
                backup_via(group: "stash.appscode.com", kind: "BackupConfiguration") {
                  refs: view(group: $targetGroup, kind: $targetKind) {
                    namespace
                    name
                  }
                }
              }
            }
          type: GraphQL
        ref:
          group: ui.stash.appscode.com
          kind: BackupOverview
  - name: Security
    sections:
    - blocks:
      - kind: Custom
        name: CVE Report
      name: CVE Report
    - blocks:
      - kind: Block
        name: rbac.authorization.k8s.io-v1-accesscontrols
      name: Access Control
    - blocks:
      - kind: Block
        name: cert-manager.io-v1-tls
      name: TLS
    - blocks:
      - kind: Block
        name: policy-v1-policies
      name: Policies
    - blocks:
      - kind: Block
        name: falco.appscode.com-v1alpha1-falcoevents-app
      name: Runtime Security
  resource:
    group: kubedb.com
    kind: Postgres
    name: postgreses
    scope: Namespaced
    version: v1alpha2
  tabBar:
    actions:
      create: Never
    displayMode: Field
    kind: Connection
    query:
      byLabel: view
      type: GraphQL
    ref:
      group: core.k8s.appscode.com
      kind: GenericResourceService
    view:
      name: core.k8s.appscode.com-v1alpha1-genericresourceservices-kubedb
